<!--
  This file is part of the "FnordMetric" project
    Copyright (c) 2014 Laura Schlimmer
    Copyright (c) 2014 Paul Asmuth, Google Inc.

  FnordMetric is free software: you can redistribute it and/or modify it under
  the terms of the GNU General Public License v3.0. You should have received a
  copy of the GNU General Public License along with this program. If not, see
  <http://www.gnu.org/licenses/>.
-->
<style type="text/css">
  fn-popup {
    display: none;
  }

  fn-popup[data-active="active"] {
    display: block;
  }
</style>

<template id='fn-popup-base-tpl'>
  <style type='text/css'>
    .background {
      position: fixed;
      top: 0;
      left:0;
      height: 100%;
      width: 100%;
      z-index: 1000;
      background: #e9ebed;
      opacity: 0.5;
      display: table;
      text-align: center;
    }

    .inner {
      position: fixed;
      min-height: 400px;
      width: 40%;
      min-width: 700px;
      z-index: 2000;
      border: 1px solid #dbdedf;
      left: 30%;
      top:90px;
      background-color: #fff;
      border-radius: 3px;
      box-shadow: 0 0 3px rgba(0,0,0,.1);
      opacity: 1;
    }

    .fa.fa-times {
      float:left;
      padding: 5px;
    }

    .fa.fa-times:hover {
      color: #009fe9;
      cursor: pointer;
    }

  </style>
  <div class="background"></div>
  <div class="inner">
    <i class="fa fa-times"></i>
    <content></content>
  </div>
</template>

<script type='text/javascript'>
  var PopupComponent = function() {
    this.createdCallback = function() {
      var shadow = this.createShadowRoot();
      var tpl = Fnord.getTemplate("fn-popup", "base");
      shadow.appendChild(tpl);

      var base = this;
      var background = this.shadowRoot.querySelector(".background");
      background.addEventListener('click', function() {
        base.closePopup();
      }, false);

      var close_btn = this.shadowRoot.querySelector(".fa.fa-times");
      close_btn.addEventListener('click', function() {
        base.closePopup();
      }, false);

    };

    this.setContent = function(content) {
      var inner_view = this.shadowRoot.querySelector(".inner");
      content.id = 'inner_content';
      inner_view.appendChild(content);
    };

    this.clearContent = function() {
      var inner_view = this.shadowRoot.querySelector(".inner");
      var content = inner_view.querySelector("#inner_content");
      if (content != null) {
        inner_view.removeChild(content);
      }
    }

    this.closePopup = function() {
      this.removeAttribute("data-active");
    }
  }

  window.addEventListener('fn-ready', function() {
    var popup = Fnord.registerComponent('fn-popup', PopupComponent);
  }, false);
</script>
