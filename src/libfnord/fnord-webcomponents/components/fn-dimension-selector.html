<!--
  This file is part of the "FnordMetric" project
    Copyright (c) 2015 Laura Schlimmer
    Copyright (c) 2015 Paul Asmuth

  FnordMetric is free software: you can redistribute it and/or modify it under
  the terms of the GNU General Public License v3.0. You should have received a
  copy of the GNU General Public License along with this program. If not, see
  <http://www.gnu.org/licenses/>.
-->

<template id="fn-dimension-selector-base-tpl">
  <fn-modal-dimmer>
    <fn-modal>
      <fn-modal-close-icon></fn-modal-close-icon>

      <fn-dimension-selector-view data-view='dimension-option' data-active>
        <fn-modal-header>Select Dimension Option</fn-modal-header>

        <fn-dimension-selector-inner-view>
          <fn-dimension-selector-row data-option='drilldown' data-clickable>
            Add Drilldown
          </fn-dimension-selector-row>
          <fn-dimension-selector-row data-option='segment' data-clickable>
            Add Segment
          </fn-dimension-selector-row>
        </fn-dimension-selector-inner-view>
      </fn-dimension-selector-view>

      <fn-dimension-selector-view data-view='drilldown-dimension'>
        <fn-modal-header>Add Drilldown</fn-modal-header>

        <fn-dimension-selector-inner-view>
        </fn-dimension-selector-inner-view>
      </fn-dimension-selector-view>
    </fn-modal>
  </fn-modal-dimmer>
</template>
<script type='text/javascript'>
  var DimensionSelector = function() {
    this.createdCallback = function() {
      var tpl = Fnord.getTemplate('fn-dimension-selector', 'base');
      this.appendChild(tpl);
      this.init();
    };

    this.init = function() {
      var _this = this;
      this.querySelector("[data-option='drilldown']").addEventListener(
        'click', function() {
          _this.changeView('drilldown-dimension');
        }, false);

      this.querySelector("[data-option='segment']").addEventListener(
        'click', function() {

        }, false);

    };

    this.changeView = function(view) {
      var active_view = this.querySelector("[data-view][data-active]");

      if (active_view.getAttribute('data-view') != view) {
        active_view.removeAttribute('data-active');
        this.querySelector("[data-view='" + view + "']").setAttribute(
          'data-active', 'active');
      }
    }

    this.show = function() {
      this.changeView('dimension-option');
      this.querySelector("fn-modal").show();
    };
  };

  window.addEventListener('fn-ready', function() {
    Fnord.registerComponent('fn-dimension-selector', DimensionSelector);
  });
</script>
